# 黑胶唱片模式 - 更新说明

## 概述
重新设计了黑胶唱片模式（Vinyl Mode），实现了真正的"歌词刻在唱片上"的效果。

## 设计理念 ✨

### 核心概念
- **整个页面就是一张唱片**：不再是左右分栏布局，而是将整个页面作为一个完整的黑胶唱片
- **封面在圆心**：专辑封面位于唱片的中心，作为唱片的中心点
- **歌词刻在唱片上**：歌词围绕封面呈圆形排列，就像刻在唱片沟槽上的纹理
- **同步旋转**：当唱片旋转时，歌词随着唱片一起旋转，角度和位置同步变化

## 技术实现

### 新增组件
创建了 `VinylLyricsCircular.tsx` 组件，实现圆形歌词效果：

#### 核心特性
1. **圆形布局**
   - 歌词沿着圆周排列
   - 每行歌词有独立的角度位置
   - 使用极坐标转换计算每行歌词的 x, y 坐标

2. **旋转同步**
   - 歌词容器随着 `rotation` 参数同步旋转
   - 使用 CSS `transform: rotate()` 实现流畅旋转
   - 旋转速度：每8秒旋转360度

3. **智能显示**
   - 只显示当前播放行附近的歌词（前后各4行）
   - 避免歌词过于拥挤
   - 当前播放行高亮显示

4. **视觉效果**
   - 当前行：大字号、粗体、发光效果
   - 其他行：较小字号、半透明
   - 距离当前行越远，半径越大（营造立体感）

### 修改的组件
重构了 `ImmersiveLyricsPanel.tsx` 主面板：

#### 布局变化
- **之前**：左右分栏（左侧封面，右侧歌词滚动）
- **现在**：整页作为唱片（中心封面，歌词围绕）

#### 结构层次
```
- 背景模糊层
  - 唱片主体
    - 歌词层（绝对定位，铺满整个页面）
      - VinylLyricsCircular 组件（随旋转角度旋转）
    - 封面层（居中，z-index 更高）
      - 外圈装饰（黑胶唱片边缘）
      - 专辑封面（圆形，会旋转）
      - 中心圆点（唱片中心）
  - 歌曲信息（固定在底部）
  - 关闭按钮（右上角）
```

## 视觉设计细节

### 唱片沟槽效果
- 添加了多个同心圆，模拟黑胶唱片的沟槽
- 使用半透明边框创建细腻的纹理

### 封面设计
- **尺寸**：300px × 300px 圆形
- **外圈装饰**：320px × 320px，带渐变光晕
- **中心圆点**：12px × 12px，模拟唱片中心孔

### 歌词显示
- **唱片半径**：350px
- **歌词分布范围**：280px - 380px（根据距离当前行的远近调整）
- **角度分布**：360度均匀分布或按歌词数量自动调整
- **字体大小**：
  - 当前行原文：1.5rem，粗体700
  - 当前行译文：0.9rem
  - 其他行原文：1rem
  - 其他行译文：0.7rem

### 动画效果
- **旋转动画**：使用 `requestAnimationFrame` 实现流畅旋转
- **歌词切换**：0.5s 缓动过渡
- **发光效果**：当前歌词行有双层文字阴影

## 用户体验

### 交互功能
- ✅ 点击歌词行可跳转到对应时间点
- ✅ 暂停时唱片停止旋转但保持当前角度
- ✅ 播放时唱片平滑旋转
- ✅ 歌词随旋转而移动和旋转

### 视觉反馈
- 当前播放行有明显的视觉强调（大字号、发光）
- 其他行半透明，不干扰当前行
- 底部显示歌曲信息，不遮挡唱片主体

## 技术亮点

1. **性能优化**
   - 只渲染可见的歌词行（当前行±4行）
   - 使用 `React.memo` 防止不必要的重渲染
   - `requestAnimationFrame` 实现高效旋转动画

2. **数学计算**
   - 极坐标系统转换（角度 → x, y 坐标）
   - 动态半径计算（根据距离调整）
   - 角度归一化（0-360度循环）

3. **CSS 变换**
   - 嵌套 transform 实现复杂旋转效果
   - 平滑过渡和动画
   - 层叠上下文管理

## 使用方法

在沉浸式歌词界面中，选择"黑胶唱片"（vinyl）布局样式即可体验新的效果。

## 文件清单

### 新增文件
- `src/components/immersive/VinylLyricsCircular.tsx` - 圆形歌词组件

### 修改文件
- `src/components/immersive/ImmersiveLyricsPanel.tsx` - 重构布局
- `src/components/ImmersiveLyricsView.tsx` - 类型修复
- `src/components/immersive/AlbumCoverRotating.tsx` - 清理未使用代码
- `src/components/immersive/ImmersiveLyricsScroll.tsx` - 清理未使用代码
- `src/components/TracksView.tsx` - 清理未使用代码

## 效果预览

```
           [关闭按钮]
           
                     ╱───╲
                   ╱   歌   ╲
         [歌词]   │  词4  │   [歌词]
      [歌词3]     │       │     [歌词5]
                  │ ┌───┐ │
      [歌词2]     │ │封面│ │     [歌词6]
                  │ │旋转│ │
      [歌词1]     │ └───┘ │     [歌词7]
                  │       │
                   ╲  歌  ╱
                     ╲─词─╱
           
         [歌曲名称]
         [艺术家]
         [专辑]
```

## 注意事项

- 歌词内容较长时会自动换行，但建议使用简洁的歌词
- 移动端可能需要调整半径参数以适应小屏幕
- 旋转速度可通过修改 `0.045` 参数调整（文件：ImmersiveLyricsPanel.tsx）

## 未来优化方向

1. **响应式设计**：根据屏幕尺寸自动调整唱片和歌词大小
2. **更多交互**：鼠标悬停歌词时放大显示
3. **自定义选项**：允许用户调整旋转速度、歌词数量等
4. **动画增强**：添加更多唱片效果（如针臂、光盘反射等）
