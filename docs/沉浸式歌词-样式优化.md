# 沉浸式歌词 - 样式优化

> 日期: 2025-10-06  
> 问题: 前后歌词也放大和发光，视觉混乱  
> 状态: ✅ 已修复

---

## 🐛 问题描述

在沉浸式歌词界面，当前正在播放的歌词前后的歌词也会放大和发光，导致视觉焦点不够集中。

### 修改前的效果
- 当前歌词：放大 120% + 发光
- 前后相邻歌词（distance = 1）：放大 108% + 中等发光
- 再远歌词（distance = 2,3...）：正常大小 + 轻微发光

**问题**：太多歌词有特殊效果，用户难以快速识别当前播放的歌词。

---

## ✅ 解决方案

**修改逻辑**：只有当前播放的歌词放大和发光，其他所有歌词保持正常大小且不发光。

### 修改的文件

**文件**: `src/components/lyrics/LyricLine.tsx`

### 具体修改

#### 1. 缩放效果（Scale）

**修改前**：
```typescript
const scale = isCurrent 
  ? 1.2        // 当前行：放大20%
  : distance === 1
    ? 1.08     // 相邻行：放大8%
    : 1;       // 其他行：正常大小
```

**修改后**：
```typescript
// 🔥 只有当前播放的歌词放大，其他歌词保持正常大小
const scale = isCurrent 
  ? 1.2        // 当前行：放大20%
  : 1;         // 其他所有行：正常大小
```

#### 2. 文字发光效果（Text Shadow）

**修改前**：
```typescript
textShadow: isCurrent 
  ? `0 0 20px rgba(255, 255, 255, 0.7), ...` 
  : distance === 1
    ? '0 0 10px rgba(255, 255, 255, 0.35), ...'
    : distance === 2
      ? '0 0 5px rgba(255, 255, 255, 0.2), ...'
      : distance === 3
        ? '0 0 3px rgba(255, 255, 255, 0.12), ...'
        : '0 1px 2px rgba(255, 255, 255, 0.04)',
```

**修改后**：
```typescript
// ✅ 发光效果：只有当前播放的歌词发光
textShadow: isCurrent 
  ? `0 0 20px rgba(255, 255, 255, 0.7), 0 0 35px rgba(255, 255, 255, 0.5), 0 2px 12px rgba(255, 255, 255, 0.4)` 
  : 'none',  // 🔥 其他歌词不发光
```

#### 3. 阴影滤镜（Drop Shadow）

**修改前**：
```typescript
filter: isCurrent 
  ? 'drop-shadow(0 0 10px rgba(255, 255, 255, 0.3))' 
  : distance === 1
    ? 'drop-shadow(0 0 5px rgba(255, 255, 255, 0.15))'
    : distance === 2
      ? 'drop-shadow(0 0 3px rgba(255, 255, 255, 0.08))'
      : distance === 3
        ? 'drop-shadow(0 0 2px rgba(255, 255, 255, 0.04))'
        : 'drop-shadow(0 0 1px rgba(255, 255, 255, 0.02))',
```

**修改后**：
```typescript
// ✅ drop-shadow 只有当前歌词有发光效果
filter: isCurrent 
  ? 'drop-shadow(0 0 10px rgba(255, 255, 255, 0.3))' 
  : 'none',  // 🔥 其他歌词不发光
```

#### 4. 字体粗细和字间距

**修改前**：
```typescript
fontWeight: isCurrent ? 600 : distance === 1 ? 500 : 400,
letterSpacing: isCurrent ? '0.02em' : distance === 1 ? '0.012em' : '0.005em',
```

**修改后**：
```typescript
// 🔥 只有当前歌词加粗和增加字间距
fontWeight: isCurrent ? 600 : 400,
letterSpacing: isCurrent ? '0.02em' : '0.005em',
```

#### 5. 过渡动画优化

**修改前**：
```typescript
transition: isCurrent || distance === 1
  ? 'transform 0.8s ..., color 0.6s ..., text-shadow 0.8s ..., ...' 
  : 'transform 0.6s ..., color 0.5s ..., text-shadow 0.6s ..., ...',
```

**修改后**：
```typescript
// ✅ 只为当前歌词添加完整过渡
transition: isCurrent
  ? 'transform 0.8s ..., color 0.6s ..., text-shadow 0.8s ..., ...' 
  : 'color 0.5s ease-out',  // 🔥 其他歌词只需颜色过渡
```

**外层容器过渡**：
```typescript
// 修改前
transition: isCurrent || distance === 1
  ? `opacity 1.2s ..., filter 1.2s ...`
  : `opacity 0.9s ..., filter 0.9s ...`,

// 修改后
transition: isCurrent
  ? `opacity 1.2s ..., filter 1.2s ...`
  : `opacity 0.9s ...`,  // 🔥 非当前歌词只需 opacity 过渡
```

---

## 🎨 视觉效果对比

### 修改前
```
[其他歌词 - 小字 - 无光]
[接近歌词 - 中字 - 微光] ← 有放大和发光
[当前歌词 - 大字 - 强光] ← 当前播放
[接近歌词 - 中字 - 微光] ← 有放大和发光
[其他歌词 - 小字 - 无光]
```

**问题**：3 行歌词有特殊效果，视觉焦点分散

### 修改后
```
[其他歌词 - 正常 - 无光]
[其他歌词 - 正常 - 无光]
[当前歌词 - 大字 - 强光] ← 唯一焦点
[其他歌词 - 正常 - 无光]
[其他歌词 - 正常 - 无光]
```

**效果**：只有 1 行歌词有特殊效果，视觉焦点明确

---

## 📊 保留的效果

虽然只有当前歌词放大和发光，但其他效果仍然保留，确保整体视觉体验：

| 效果 | 当前歌词 | 其他歌词 | 说明 |
|------|---------|---------|------|
| **缩放** | 120% | 100% | ✅ 只有当前歌词放大 |
| **发光** | 强光 | 无 | ✅ 只有当前歌词发光 |
| **颜色** | 纯白 | 根据距离渐变 | ✅ 保留渐变效果 |
| **透明度** | 100% | 根据距离递减 | ✅ 保留渐变效果 |
| **模糊** | 无 | 根据距离递增 | ✅ 保留模糊效果 |
| **字重** | 600 | 400 | ✅ 只有当前歌词加粗 |

---

## 🎯 用户体验改进

### 修改前
- ❌ 视觉焦点分散（3 行歌词有特殊效果）
- ❌ 难以快速识别当前歌词
- ❌ 前后歌词的放大和发光有干扰

### 修改后
- ✅ 视觉焦点集中（只有 1 行歌词有特殊效果）
- ✅ 一眼识别当前播放的歌词
- ✅ 其他歌词保持低调，不干扰视线
- ✅ 保留颜色、透明度、模糊的渐变效果

---

## 🧪 测试场景

### 场景 1：正常播放
1. 打开沉浸式歌词
2. 播放歌曲
3. 观察歌词切换

**预期**：
- 只有当前播放的歌词放大且发光
- 其他所有歌词保持正常大小，不发光
- 歌词切换流畅

### 场景 2：快速切换
1. 点击不同位置的歌词快速跳转
2. 观察效果切换

**预期**：
- 放大和发光效果快速切换到新的当前歌词
- 之前的歌词立即恢复正常

### 场景 3：长时间播放
1. 播放完整歌曲
2. 观察整体视觉效果

**预期**：
- 视觉焦点始终明确
- 不会感到混乱或疲劳

---

## 📝 代码行数统计

- 修改文件：1 个（`src/components/lyrics/LyricLine.tsx`）
- 删除代码：约 40 行（渐进式效果逻辑）
- 修改代码：约 15 行（简化条件判断）
- 代码更简洁，逻辑更清晰

---

## 🎉 总结

### 修改目标
只有当前播放的歌词放大和发光，其他歌词保持正常。

### 实现方式
简化 `LyricLine.tsx` 中的条件逻辑，移除 `distance === 1`, `distance === 2` 等渐进式效果。

### 用户收益
- ✅ 视觉焦点更集中
- ✅ 一眼识别当前歌词
- ✅ 更好的可读性
- ✅ 更清爽的界面

### 性能影响
- ✅ 更少的 CSS 计算
- ✅ 更简单的过渡动画
- ✅ 更快的渲染速度

---

**修复完成！沉浸式歌词现在只有当前播放的歌词会放大和发光！** 🎉


