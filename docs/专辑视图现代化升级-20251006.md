# 专辑视图现代化升级

## 更新日期
2025-10-06

## 概述
对专辑视图进行了全面的现代化升级，打造更优雅、更具沉浸感的专辑浏览体验。

## 主要改进

### 1. 网格布局优化
- **响应式网格**: 采用 CSS Grid 自动填充布局，适配不同屏幕尺寸
- **动态封面尺寸**: 
  - 超大屏幕 (≥1920px): 200px
  - 大屏幕 (≥1600px): 180px
  - 中大屏幕 (≥1280px): 165px
  - 中等屏幕 (≥1024px): 150px
  - 小屏幕 (≥768px): 140px
  - 移动端 (<768px): 130px
- **智能间距**: 使用 `clamp()` 函数根据封面尺寸自动调整间距
- **居中对齐**: 专辑信息文字采用居中布局，与封面形成视觉平衡
- **平滑过渡**: 窗口大小变化时，尺寸和间距平滑过渡

### 2. 3D 悬停效果
- **立体提升**: 鼠标悬停时封面带有 3D 透视效果，向上浮起 8px
- **微妙旋转**: 添加轻微的 X/Y 轴旋转（rotateX: 1.2deg, rotateY: 0.6deg）
- **阴影增强**: 多层阴影逐级加深，营造真实的浮起感
- **文字跟随**: 专辑名称在悬停时微微上移，增强互动感

### 3. 动态高光系统
- **鼠标跟随**: 高光随鼠标位置实时变化
- **方向性渐变**: 根据鼠标位置计算角度，动态调整渐变方向
- **强度计算**: 靠近中心时高光更强，边缘渐弱
- **性能优化**: 使用 requestAnimationFrame 节流，避免性能问题

### 4. 精致的视觉细节
- **多层叠加效果**:
  - 基础封面图层
  - 动态高光层（::before）
  - 底部渐变层（::after）
- **边框细节**: 细腻的 1px 边框，深浅色模式自适应
- **混合模式**: 使用 overlay 混合模式让高光更自然
- **圆角统一**: 12px 圆角，现代而不失优雅

### 5. 深浅色模式支持
- **自适应阴影**: 深色模式下阴影更重更深
- **边框调整**: 深色模式使用白色半透明边框
- **高光优化**: 深色模式下高光强度适当降低

### 6. 响应式设计
- **动态适配**: 窗口大小实时监听，自动调整布局
- **防抖优化**: resize 事件采用 150ms 防抖，避免频繁重绘
- **智能间距**: 使用 `clamp(1rem, calc(size * 0.12), 2.5rem)` 自动计算间距
- **平滑动画**: 尺寸变化时使用 0.3s 过渡动画

### 7. 抽屉式详情面板
- **点击展开**: 点击专辑卡片，右侧展开详情面板
- **动态侧边栏**: 左侧专辑列表收缩为侧边栏，宽度随窗口自适应
- **平滑过渡**: 500ms 缓动动画，视觉流畅自然
- **保持交互**: 侧边栏仍可滚动和选择其他专辑
- **ESC 关闭**: 支持键盘快捷键快速关闭详情
- **渐变动画**: 进入/退出时带淡入淡出效果

## 技术实现

### CSS 变量
```css
--cover-size: 165px;  /* 封面尺寸 */
--mx: 0.5;            /* 鼠标 X 坐标 (0-1) */
--my: 0.5;            /* 鼠标 Y 坐标 (0-1) */
--gloss: 0;           /* 高光强度 (0-1) */
--ang: 0;             /* 高光角度（度） */
```

### 核心样式类
- `.albums-grid-modern`: 响应式网格容器
- `.album-card-modern`: 专辑卡片
- `.album-cover-modern`: 封面容器（含 3D 效果）
- `.album-info-modern`: 信息区域
- `.album-name-modern`: 专辑名称
- `.album-artist-modern`: 艺术家信息

### JavaScript 交互
```typescript
// 窗口大小监听（带防抖）
const handleResize = () => {
  clearTimeout(resizeTimer);
  resizeTimer = window.setTimeout(updateCoverSize, 150);
};

// 鼠标高光跟随（带 RAF 节流）
const handleMouseMove = (e, artEl) => {
  if (artEl._rafId) return;
  artEl._rafId = requestAnimationFrame(() => {
    // 计算位置、角度、强度
    const angle = Math.atan2(y - 0.5, x - 0.5) * 180 / Math.PI;
    artEl.style.setProperty('--ang', angle.toFixed(2));
  });
};
```

## 文件修改

### 新增文件
- `src/styles/albums-view.css`: 专辑视图专用样式

### 修改文件
- `src/components/AlbumsView.tsx`:
  - 引入新样式
  - 更新网格布局类名
  - 优化鼠标高光跟随逻辑
  - 添加角度计算

## 用户体验提升

1. **视觉冲击**: 3D 效果让专辑封面更具真实感
2. **交互反馈**: 悬停时的立体提升和高光变化，增强操作确认感
3. **浏览流畅**: 优雅的动画过渡，自然的视觉引导
4. **细节打磨**: 从阴影到圆角，每个细节都经过精心调整

## 性能优化

### 动画性能
- 使用 `will-change` 提示浏览器优化动画
- CSS 硬件加速（transform、opacity）
- 避免重排，仅使用 transform 和 opacity

### 事件优化
- **RAF 节流**: 鼠标移动事件使用 `requestAnimationFrame` 节流
- **Resize 防抖**: 窗口大小变化采用 150ms 防抖处理
- **条件渲染**: 仅在网格模式下启用高光跟随效果

### 渲染优化
- **CSS 变量**: 动态属性通过 CSS 变量实时更新
- **智能计算**: 间距使用 `clamp()` 一次性计算
- **分层动画**: 抽屉展开时使用分层渐变，避免大范围重绘

## 兼容性

- 支持所有现代浏览器
- CSS Grid 和 CSS 变量
- Flexbox 布局
- CSS 混合模式

## 后续可能的优化

- [ ] 添加封面加载骨架屏
- [ ] 实现虚拟滚动优化大量专辑性能
- [ ] 添加专辑分组/排序动画
- [ ] 支持拖拽重排专辑

## 总结

此次升级将专辑视图从功能性界面提升为视觉艺术，在保持性能的同时，为用户带来更加沉浸、优雅的音乐浏览体验。
