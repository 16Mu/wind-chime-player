# WEBDAV 开发后必须看手册

本手册用于指导在 WebDAV 模块完成开发后如何恢复、验证和维护相关功能，确保上线体验稳定、可控。

## 1. 功能总览
- **稳定入口**：设置页中的 `WEBDAV开发后使用` 标签，承载已完成功能的日常使用面板。
- **开发状态页**：`WEBDAV开发中` 标签展示开发进度、限制说明及后续计划，方便快速定位尚未落地的能力。
- **核心能力**：服务器管理（新增、测试、删除）、缓存统计、远程扫描与文件浏览。

## 2. 还原"WEBDAV开发后使用"Tab入口

### 2.1 当前状态
该Tab已在 `src/components/SettingsPageNew.tsx` 中被临时屏蔽（第60-66行）。

### 2.2 还原操作
打开 `src/components/SettingsPageNew.tsx`，找到约第60行的注释块：

```typescript
// 【临时屏蔽】WEBDAV开发后使用入口 - 还原请参考 docs/WEBDAV开发后必须看.md
// { 
//   id: 'webdav', 
//   label: 'WEBDAV开发后使用', 
//   emoji: '📻',
//   icon: 'M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z' 
// },
```

**取消注释**，恢复为：

```typescript
// 🚧 WebDAV 功能开发中，暂时注释
{ 
  id: 'webdav', 
  label: 'WEBDAV开发后使用', 
  emoji: '📻',
  icon: 'M3 15a4 4 0 004 4h9a5 5 0 10-.1-9.999 5.002 5.002 0 10-9.78 2.096A4.001 4.001 0 003 15z' 
},
```

保存文件后，重启开发服务器或重新构建应用。

### 2.3 验证还原
- 打开应用设置页，应能看到 `WEBDAV开发后使用` Tab出现在顶部导航栏。
- 点击该Tab，确认服务器列表、统计面板正常显示。

## 3. 完整功能恢复步骤
1. **同步代码与依赖**
   - 拉取主分支最新代码并执行依赖安装：`pnpm install`。
   - 运行一次 `pnpm tauri dev` 或对应构建指令，确保依赖链完整。
2. **还原Tab入口**
   - 按照 **2.2 还原操作** 取消注释被屏蔽的Tab配置。
3. **初始化配置**
   - 打开应用 → 进入设置页 → 切换至 `WEBDAV开发中`，确认提示信息无异常。
   - 切换至 `WEBDAV开发后使用`，执行一次"刷新数据"与"检查所有连接"。
4. **数据恢复**
   - 若存在历史 WebDAV 服务器配置，使用导出的配置 JSON 手动导入或重新录入。
   - 观察缓存统计卡片是否能正确显示文件条目和缓存大小。必要时点击"远程扫描"重新生成缓存。

## 4. 验证清单
- `WEBDAV开发后使用` 面板：
  - 新增服务器、测试连接、确认提示文案均符合预期。
  - 浏览按钮可唤起文件浏览器，关闭后状态恢复正常。
- `WEBDAV开发中` 面板：
  - 三个 SettingSection 内容完整，徽章状态正确。
  - 描述文案与当前开发阶段一致，无需滚动即可阅读核心提示。
- 全局：
  - 顶部设置页 Tab 滑动指示器未错位。
  - 暗色 / 浅色模式下无明显样式问题。

## 5. 常见问题处理
- **连接测试失败**：检查 URL、认证信息，并确认服务器支持 HTTPS/SSL；必要时关闭校验证书选项重试。
- **缓存统计为 0**：触发"检查所有连接"或手动执行远程扫描，确认后台任务运行；查看日志是否存在权限错误。
- **界面无法加载**：清除本地 Storage 缓存后重启应用；若仍失败，检查 `RemoteSourceContext` 是否报错。
- **还原Tab后页面报错**：确认 `WebDAVSettings` 组件文件完整，检查是否有 TypeScript 类型错误。

## 6. 更新维护建议
- 继续迭代时，请在 `WEBDAV开发中` 面板同步调整里程碑描述，保持信息准确。
- 对外发布前，建议在该文档末尾追加版本记录，如“2025-10-04：新增开发状态页”。
- 若引入重大变更（例如配置存储格式调整），务必在此手册补充迁移指引与回滚方案。

---
**维护人建议**：将本手册纳入上线前检查清单，确保每次发布都执行全量自检，降低回归风险。

## 7. 版本记录

### 2025-10-04
- **新增功能**：
  - 创建"WEBDAV开发中"状态页，展示开发进度与后续计划
  - 重命名原WebDAV Tab为"WEBDAV开发后使用"
  
- **临时变更**：
  - 屏蔽"WEBDAV开发后使用"Tab入口（第60-66行）
  - 添加完整还原指南（本文档第2章节）
  
- **相关文件**：
  - `src/components/SettingsPageNew.tsx` - Tab配置文件
  - `src/components/settings/WebDAVSettings.tsx` - 功能入口组件
  - `src/components/settings/WebDAVDevelopmentStatus.tsx` - 开发状态页组件

