# 🎵 歌单系统完整功能清单

更新时间：2025-10-03

---

## 📊 功能实现情况总览

| 模块 | 后端API | 前端UI | 可用性 | 状态 |
|------|---------|--------|--------|------|
| **歌单CRUD** | ✅ 100% | ✅ 100% | ✅ 完全可用 | 完成 |
| **智能歌单** | ✅ 100% | ✅ 100% | ✅ 完全可用 | 完成 |
| **添加曲目** | ✅ 100% | ❌ 0% | ❌ **不可用** | **致命缺陷** |
| **移除曲目** | ✅ 100% | ✅ 100% | ✅ 完全可用 | 完成 |
| **曲目排序** | ✅ 100% | ❌ 0% | ❌ 不可用 | 待实现 |
| **批量操作** | ✅ 100% | ❌ 0% | ❌ 不可用 | 待实现 |
| **导入导出** | ✅ 100% | ❌ 0% | ❌ 不可用 | 待实现 |
| **右键菜单** | N/A | ❌ 0% | ❌ 不可用 | 待实现 |

**总体可用性：60%** ⚠️

---

## ✅ 已实现功能

### 1. 歌单基础管理
- ✅ 创建歌单（名称、描述、颜色主题）
- ✅ 查看歌单列表（网格/列表视图）
- ✅ 查看歌单详情
- ✅ 编辑歌单信息
- ✅ 删除歌单（带确认）
- ✅ 收藏/取消收藏歌单

### 2. 智能歌单
- ✅ 创建智能歌单
- ✅ 编辑智能规则
- ✅ 手动刷新智能歌单
- ✅ 批量刷新所有智能歌单
- ✅ 支持多种规则字段（标题、艺术家、专辑、时长、日期、播放次数等）
- ✅ 支持多种操作符（等于、包含、大于、小于等）
- ✅ 支持规则组合（AND/OR逻辑）

### 3. 曲目管理（部分）
- ✅ 查看歌单曲目列表
- ✅ 播放歌单中的曲目
- ✅ 从歌单移除单个曲目
- ✅ 显示曲目信息（标题、艺术家、专辑、时长）

### 4. 搜索与筛选
- ✅ 搜索歌单（按名称、描述）
- ✅ 筛选歌单（全部/智能/收藏/普通）
- ✅ 排序歌单（创建时间/名称/曲目数/播放次数）
- ✅ 切换视图模式（网格/列表）

### 5. 统计信息
- ✅ 总歌单数
- ✅ 智能歌单数
- ✅ 收藏歌单数
- ✅ 歌单中总曲目数

---

## ❌ 未实现功能（按优先级）

### 🔴 P0 - 致命缺陷（影响核心功能）

#### 1. 添加曲目到歌单 ⚠️ **最严重**
**影响**：除了智能歌单，普通歌单无法添加曲目，基本不可用

**缺失位置**：
- ❌ 音乐库中没有"添加到歌单"入口
- ❌ TrackRow没有"添加到歌单"按钮
- ❌ 没有右键菜单选项
- ❌ 歌单详情的"添加曲目"按钮未连接逻辑

**后端支持**：✅ `playlists_add_tracks` 已实现

**需要实现**：
1. 创建歌单选择对话框组件
2. 在音乐库添加"添加到歌单"入口
3. 在歌单详情实现"添加曲目"功能

---

### 🔴 P1 - 重要功能（影响用户体验）

#### 2. 批量操作
**影响**：效率低下，一次只能操作一个项目

**缺失内容**：
- ❌ 音乐库没有批量选择模式
- ❌ 无法批量添加曲目到歌单
- ❌ 无法批量移除歌单中的曲目
- ❌ 没有全选/反选功能

**后端支持**：✅ `playlists_add_tracks` 支持批量

#### 3. 右键菜单
**影响**：交互不便，需要多次点击

**缺失内容**：
- ❌ 音乐库曲目没有右键菜单
- ❌ 歌单列表没有右键菜单
- ❌ 歌单曲目没有右键菜单

**应该包含**：
- 播放
- 添加到歌单（子菜单）
- 添加到收藏
- 查看信息
- 删除/移除

---

### 🟡 P2 - 增强功能（优化体验）

#### 4. 拖拽排序曲目
**影响**：无法自定义曲目顺序

**缺失内容**：
- ❌ 歌单详情不支持拖拽排序

**后端支持**：✅ `playlists_reorder_tracks` 已实现

**需要实现**：
- 集成拖拽库（react-beautiful-dnd 或原生API）
- 添加拖拽手柄
- 实现拖拽反馈

#### 5. 导入导出UI
**影响**：功能不完整，无法备份/分享歌单

**缺失内容**：
- ❌ 导出对话框（选择格式、保存位置）
- ❌ 导入功能（选择文件）
- ❌ 格式选择UI

**后端支持**：✅ 完整支持
- `playlists_export` (M3U/M3U8/JSON)
- `playlists_import`
- `playlists_export_preview`

**需要实现**：
- 创建导出对话框
- 集成Tauri文件选择器
- 显示导入进度

---

### 🟢 P3 - 可选功能（锦上添花）

#### 6. 歌单分享
**影响**：无法与他人分享歌单

**需要考虑**：
- 分享方式（文件？链接？）
- 权限控制
- 是否需要在线服务

#### 7. 曲目详情/编辑
**影响**：无法查看完整元数据、编辑信息

**需要实现**：
- 曲目详情对话框
- 元数据编辑功能
- 集成ID3标签编辑

#### 8. 歌单封面上传
**影响**：无法自定义歌单封面

**当前状态**：UI支持显示封面，但没有上传功能

#### 9. 歌单播放模式
**影响**：无法直接播放整个歌单

**需要实现**：
- "播放全部"按钮
- 随机播放歌单
- 循环播放歌单

---

## 🔧 快速修复建议

### 最小可用方案（1-2小时）

只实现**添加曲目到歌单**基础功能：

1. 创建简单的歌单选择对话框
```tsx
<PlaylistSelector
  onSelect={(playlistId) => addToPlaylist(trackId, playlistId)}
/>
```

2. 在TrackRow添加按钮（hover显示）
```tsx
<button onClick={openPlaylistSelector}>
  + 添加到歌单
</button>
```

3. 在歌单详情实现"添加曲目"
- 复用音乐库的TracksView组件
- 多选模式
- 确认添加

### 完整解决方案（1-2天）

实现前面列出的P0和P1优先级功能：
1. 添加曲目到歌单（包含右键菜单）
2. 批量操作
3. 拖拽排序（可选）

---

## 📈 改进建议

### 架构优化
1. 创建通用的ContextMenu组件
2. 创建通用的BatchActionBar组件
3. 创建通用的ItemSelector组件（可用于选择歌单、标签等）

### 用户体验
1. 添加操作提示（Toast通知）
2. 添加操作撤销功能
3. 添加拖拽时的视觉反馈
4. 添加加载状态和进度提示

---

## 📝 总结

### 当前可以做什么
- ✅ 创建和管理歌单
- ✅ 创建和使用智能歌单（自动添加曲目）
- ✅ 播放歌单中的音乐
- ✅ 从歌单移除曲目

### 当前不能做什么
- ❌ **手动添加曲目到普通歌单** ← 最大问题
- ❌ 调整曲目顺序
- ❌ 批量操作
- ❌ 导入导出歌单

### 建议
**优先实现"添加曲目到歌单"功能**，这是歌单系统的核心功能，建议采用右键菜单方案，可以同时解决多个交互问题。




